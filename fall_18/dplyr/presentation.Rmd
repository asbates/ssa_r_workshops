---
title: "SSA R Coding Workshop 2"
subtitle: "Data Cleaning & Manipulation With Dplyr"
author: "Andrew Bates"
output: ioslides_presentation
---


## This Workshop

> - Core functions of  the `dplyr` package
> - `dplyr` is part of the [tidyverse](https://www.tidyverse.org):
>     - "The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures."
> - "[dplyr](https://dplyr.tidyverse.org) is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges"
> - You **will** need to do data manipulation and cleaning
> - `dplyr` makes this easy and fun

## The Data 

> - Reviews of burritos in San Diego
> - Project of [Scott Cole](https://srcole.github.io/100burritos/), a neuroscience student at UCSD
> - Find it
>     - on his [website](https://github.com/asbates/ssa_r_workshops/tree/master/fall_18/data)
>     - or [Kaggle](https://www.kaggle.com/srcole/burritos-in-san-diego/version/2#burritos_01022018.csv)


## Setup

1. Go to https://github.com/asbates/ssa_r_workshops
2. Click the green "Clone or download" button
3. Select "Download ZIP" (unless you're familiar with Git)
4. Unzip and click on `ssa_r_workshops.Rproj` 
5. Install (if needed) and load the packages we will use
6. Read in the data

```{r setup_shown, eval = FALSE}
install.packages("dplyr", "readr", "here") 
library(dplyr)
library(readr)
library(here)
dirty_burrito <- read_csv(here("fall_18", "data", "burritos_01022018.csv"))
# or, if you don't want to use the here package
#dirty_burrito <- read_csv("path/to/file/burritos_01022018.csv")
```
     
```{r setup_hidden, echo = FALSE, message = FALSE, warning = FALSE}
library(dplyr)
library(readr)
library(here)
dirty_burrito <- read_csv(here("fall_18", "data", "burritos_01022018.csv"))

```


## First Look

```{r first_look_print}
dirty_burrito
```

## First Look
```{r first_look_names}
names(dirty_burrito)
```


## Some Issues

> - There are problems with some names:
>     - `readr` already took care of one issue (2 `Salsa` columns)
>     - Spaces in names are not very R friendly (`Mass (g)`)
>     - `Bell peper` is spelled wrong
>     - Inconsistent naming scheme (capitalization)
> - There are some `NA` values (not necessarily a problem)
> - `Chips` encoding is not so obvious (does `x` mean yes?)
> - What's the difference between `Tortilla` and `Wrap`?
> - The last two can probably be figured out with a data dictionary

## Fixing The Issues

> - To simplify things, let's start by:
>     - `select`ing just a few variables to work with
>     - and `rename`ing them

## Selecting Variables of Interest

```{r select_vars}
clean_burrito <- dirty_burrito %>%
  select(Location,
         Burrito,
         Yelp,
         Google,
         Cost,
         `Mass (g)`,
         Tortilla,
         Meat,
         Synergy,
         overall,
         Beans)
```


Note the use of backticks ` `` ` to handle the space in Mass


## Selecting Variables of Interest
```{r clean_first_pass}
clean_burrito
```


## Rename Variables

```{r rename}
clean_burrito <- clean_burrito %>%
  rename(
    location = Location,
    burrito = Burrito,
    yelp_rating = Yelp,
    google_rating = Google,
    cost = Cost,
    mass = `Mass (g)`,
    tortilla = Tortilla,
    meat = Meat,
    synergy = Synergy,
    overall_rating = overall,
    beans = Beans
  )
```

We rename using `new_name = old_name`


## Rename Variables

```{r}
clean_burrito
```

## Quiz 1

> - What does `select` do?
>     - `select`s variables (columns)
> - What does `rename` do?
>     - This should be obvious
> - What does `%>%` do?
>     - The 'pipe' operator
>     - From the package `magrittr`. Comes with `dplyr`
>     - Improves readability of code
>         - `x %>% h %>% g %>% f` instead of `f(g(h(x)))`
>         - "Take x. Apply the function h. Then g. Then f."
>     - First argument is always the data
>     - Allows for easy chaining of operations on data frame
